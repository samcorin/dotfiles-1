" autocmd
autocmd!

" set bufname to screen's title
autocmd BufEnter * if bufname("") !~ "^\[A-Za-z0-9\]*://" | silent! exe '!echo -n "\ek%:t\e\\"' | endif

filetype plugin indent on
syntax enable

" option
set ambiwidth=double
set autoindent
set background=dark
set backspace=eol,indent,start
set cindent
set expandtab
" set ignorecase
set incsearch
set list
set listchars=tab:>-,trail:-,nbsp:%,extends:>,precedes:<
set shiftwidth=4
set showmatch
set showmode
set smartcase
set tabstop=4

" encoding
set fileencoding=utf-8
set fileencodings=utf-8,iso-2022-jp,euc-jp,cp932
set fileformats=unix,dos,mac
set encoding=utf-8

" statusline
set statusline=%<%f\ %m%r%h%w%y%{'['.(&fenc!=''?&fenc:&enc).']['.&ff.']'}%=%4v\ %l/%L
set laststatus=2

" mapping
nnoremap <Leader>ev  <C-w>s:<C-u>edit $MYVIMRC<Enter>
nnoremap <Leader>ez  <C-w>s:<C-u>edit $MYZSHRC<Enter>
nnoremap <Leader>ec  <C-w>s:<C-u>edit $MYCHANGELOG_MEMO<Enter>
nnoremap <Leader>s. :<C-u>source $MYVIMRC<Enter>
nnoremap <Leader>ex  :execute '!' &ft ' %'<Enter>
nnoremap <C-h>      :<C-u>help<Space>
nnoremap <C-h><C-h> :<C-u>help<Space><C-r><C-w><Enter>

cnoremap <expr> /  getcmdtype() == '/' ? '\/' : '/'
cnoremap <expr> ?  getcmdtype() == '?' ? '\?' : '?'

" jump and move centor
nnoremap n  nzz
nnoremap N  Nzz

" noremap : ;
noremap ; :

" motion
noremap j gj
noremap k gk
noremap gj j
noremap gk k
inoremap <C-A>  <ESC>^i
noremap <C-E>   <END>
inoremap <C-E>  <END>

inoremap <expr> ,df  strftime('%Y-%m-%d %H:%M:%S')
inoremap <expr> ,dd  strftime('%Y-%m-%d')
inoremap <expr> ,dt  strftime('%H:%M:%S')

nnoremap gc `[v`]
vnoremap gc :<C-u>normal gc<Enter>
onoremap gc :<C-u>normal gc<Enter>

" Ex Command
command! Cp932      edit ++enc=cp932
command! Eucjp      edit ++enc=euc-jp
command! Iso2022jp  edit ++enc=iso-2022-jp
command! Utf8       edit ++enc=utf8

command! Jis        Iso2022jp
command! Sjis       cp932

" for ftplugin/changelog.vim
let g:changelog_timeformat = "%Y-%m-%d %H:%M:%S"
let g:changelog_username = "Keiji Yoshimi"

" 対応する括弧の強調表示はウザいので消す
let loaded_matchparen = 1

let g:ref_phpmanual_path = $HOME . "/project/dotfiles/vim/ref/php_manual_ja_html/"

